!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):window.jQuery&&!window.jQuery.fn.picker&&a(window.jQuery)}(function(a){"use strict";var b=["angle-double-down","angle-double-left","angle-double-right","angle-double-up","angle-down","angle-left","angle-right","angle-up"],c={placement:"bottom",title:!1,container:!1,animation:!0,selected:!1,defaultItem:!1,onlyValid:!0,input:"input",hideOnPick:!1,selectedCustomClass:"bg-primary",selectableItems:!1,inline:!1,displayButtons:!1,component:!1,templates:{picker:'<div class="picker"><div class="picker-items"></div></div>',item:'<div class="picker-item"><i class="fa"></i></div>',buttons:'<div class="picker-buttons"><button class="picker-button picker-button-cancel btn btn-default btn-sm">Cancel</button><button class="picker-button picker-button-accept btn btn-primary btn-sm">Accept</button></div>',popover:'<div class="popover picker-popover"><div class="arrow"></div><div class="popover-title"></div><div class="popover-content"></div></div>'}},d=0,e=function(e,f){this._id=d++,this.element=a(e).addClass("picker-element"),this.options=a.extend({},c,this.element.data(),f),this.selectableItems=this.options.selectableItems,a.isArray(this.selectableItems)&&0!==this.selectableItems.length||(this.selectableItems=b),this.component=this.options.component,this.component=this.component!==!1?this.element.find(this.component):!1,this.component!==!1&&0===this.component.length&&(this.component=!1),this.container=this.options.container===!0?this.element:this.options.container,this.container=this.container!==!1?a(this.container):!1,this.input=this.element.is("input")?this.element:this.options.input?this.element.find(this.options.input):!1,this.input!==!1&&0===this.input.length&&(this.input=!1),this._createPicker(),this._createPopover(),this._bindEvents(),this._trigger("pickerCreate"),a(a.proxy(function(){this.update(this.options.selected)},this))};e.prototype={constructor:e,options:{},_id:0,_trigger:function(b,c){c=c||{},this.element.trigger(a.extend({type:b,picker:this},c))},_error:function(a){throw"Bootstrap Popover Picker Exception: "+a},_createPopover:function(){var b=this;this.element.popover({title:this.options.title,placement:this.options.placement,container:this.container,animation:this.options.animation,template:this.options.templates.popover,content:this.picker.element,html:!0,trigger:"manual"}).on("focus.picker",function(){a(this).popover("show")}).on("show.bs.popover.picker",function(){b.update()})},_createPicker:function(b){b=b||{};var c=this,d=a(this.options.templates.picker);this.picker={element:d};var e=function(){var b=a(this);b.is(".fa")&&(b=b.parent()),c.update(b.data("pickerValue")),c._trigger("pickerPick",{pickerItem:this,pickerValue:c.pickerValue}),c.options.hideOnPick&&c.hide()};for(var f in this.selectableItems){var g=a(this.options.templates.item);g.find(".fa").addClass("fa-"+this.selectableItems[f]),g.data("pickerValue",this.selectableItems[f]).on("click.picker",e),this.picker.element.find(".picker-items").append(g.attr("title","."+this.getValue(this.selectableItems[f])))}this.options.displayButtons&&this.picker.element.append(a(this.options.templates.buttons)),this.picker=a.extend(!0,this.picker,b)},_bindEvents:function(){if(this.options.inline===!1){var b=!1,c=!1,d=a.proxy(function(b){var c=a(b.target);return c.hasClass("picker-element")&&(!c.hasClass("picker-element")||c.is(this.element))||0!==c.parents(".picker-popover").length?!0:!1},this),e=a.proxy(function(a){return d(a)||this.hide(),a.stopPropagation(),a.preventDefault(),!1},this),f=a(window.document),g=".picker.inst"+this._id;f.on("mousedown"+g,function(){f.on("mousemove"+g,function(){c=!0,f.unbind("mousemove"+g)})}),f.on("mouseup"+g,function(a){b=c===!0,c=!1,f.unbind("mousemove"+g),b||e(a)}),f.on("click.picker"+g,function(a){c=!1,f.unbind("mousemove"+g),b||e(a)}),this.hasInput()&&(this.input.on("keyup.picker",a.proxy(function(b){-1===a.inArray(b.keyCode,[38,40,37,39,16,17,18,9,8,91,93,20,46,186,190,46,78,188,44,86])&&this.update()},this)),this.input.on("click.picker"))}},_updateComponents:function(){if(this.picker.element.find(".picker-item.picker-selected").removeClass("picker-selected "+this.options.selectedCustomClass),this.picker.element.find(".fa.fa-"+this.pickerValue).parent().addClass("picker-selected "+this.options.selectedCustomClass),this.component!==!1){var a=this.component.find("i").eq(0);a.length>0?a.html(this.getValueHtml()):this.component.html(this.getValueHtml())}},_sanitizeValue:function(b){return("string"==typeof b||b instanceof String)==!1&&(b=""),a.trim(b.replace("fa-",""))},setValue:function(b){return b=this._sanitizeValue(b),-1===a.inArray(b,this.selectableItems)&&this.options.onlyValid?(console.warn("Invalid item value: "),console.log(b),!1):(this.pickerValue=b,this._updateComponents(),this._trigger("pickerChange",{pickerValue:b}),this.pickerValue)},getValue:function(a){return"fa-"+(a?a:this.pickerValue)},getValueHtml:function(){return'<i class="fa '+this.getValue()+'"></i>'},setSourceValue:function(a){return a=this.setValue(a),a!==!1&&(this.hasInput()?this.input.val(this.getValue()):this.element.data("pickerValue",this.getValue())),a},getSourceValue:function(a){a=a||this.options.defaultItem;var b=a;return b=this.hasInput()?this.input.val():this.element.data("pickerValue"),(void 0===b||""===b||null===b||b===!1)&&(b=a),b},hasInput:function(){return this.input!==!1},hasComponent:function(){return this.component!==!1},hasContainer:function(){return this.container!==!1},isDisabled:function(){return this.hasInput()?this.input.prop("disabled")===!0:!1},show:function(){this.element.popover("show")},hide:function(){this.element.popover("hide")},update:function(a){return a=a?a:this.getSourceValue(this.pickerValue),this._trigger("pickerUpdating"),this.setSourceValue(a),this._trigger("pickerUpdated"),a},destroy:function(){this.element.removeData("picker").removeData("pickerValue").off(".picker"),this.element.popover("destroy").off(".picker"),this.hasInput()&&this.input.off(".picker"),this.hasComponent()&&this.component.off(".picker"),this.hasContainer()&&this.container.off(".picker"),this.element.removeClass("picker-element"),a(window.document).off(".picker.inst"+this._id),this._trigger("pickerDestroy")},disable:function(){return this.hasInput()?(this.input.prop("disabled",!0),!0):!1},enable:function(){return this.hasInput()?(this.input.prop("disabled",!1),!0):!1}},a.picker=e,a.fn.picker=function(b){var c=arguments,d=b;if(b===!0&&(c=Array.prototype.slice.call(c,1),d=c.length>0?c[0]:!1),b!==!0&&"string"!=typeof b)return this.each(function(){var c=a(this);c.data("picker")||"string"==typeof b||c.data("picker",new e(this,"object"==typeof b?b:{}))});if("string"==typeof d||b===!0){var c=Array.prototype.slice.call(c,1);if("string"!=typeof d||""===d)return b===!0?this:!1;if(b===!0)return this.each(function(){var b=a(this).data("picker");b&&b[d].apply(b,c)});var f=this.data("picker");if(f){var g=f[d];return g&&g.constructor&&g.call&&g.apply?g.apply(f,c):g}}}});